# numpy

[![RogelioKG/numpy](https://img.shields.io/badge/Sync%20with%20HackMD-grey?logo=markdown)](https://hackmd.io/@RogelioKG/numpy)

## Note

### axis
+ <mark>array[å±¤][åˆ—][è¡Œ]</mark>
+ <mark>array.shape == (å±¤, åˆ—, è¡Œ)</mark>
  + è»¸
    > ç¬¬ -1 è»¸ä»£è¡¨è¡Œï¼Œé‚£ä»£è¡¨æ²¿è‘—ç¬¬ -1 è»¸å‰é€²æ™‚ï¼Œåªæœ‰è¡Œæœƒè®Šå‹•ã€‚\
    > æ¯”å¦‚ç¬¬ 1 è¡Œã€ç¬¬ 2 è¡Œ ... è¨˜ä½é€™é»ï¼Œå°å¿ƒåˆ¥æéŒ¯æ–¹å‘ã€‚\
    > ä»¥æ­¤é¡æ¨ï¼Œæˆ‘å€‘å¯å¾—å‡ºï¼šç¬¬ i è»¸ä¸Šæœ‰ shape[i] å€‹å…ƒç´ ã€‚
  + i = 0ï¼šç¬¬ 0 è»¸ (å±¤)
  + i = 1ï¼šç¬¬ 1 è»¸ (åˆ—)
  + i = 2ï¼šç¬¬ 2 è»¸ (è¡Œ)
  + i = -1ï¼šæœ€çµ‚è»¸ (è¡Œ)
+ <mark>è½‰ç½®ï¼šreverse æ‰€æœ‰è»¸</mark>
  > åŸæœ¬çš„ç¬¬ 0ã€1ã€2 è»¸ï¼Œè®Šæˆç¬¬ 2ã€1ã€0 è»¸
+ æ³¨æ„
  |ğŸš¨ <span class="caution">CAUTION</span>|
  |:---|
  | numpy array é è¨­è¨˜æ†¶é«”å¸ƒå±€å¾ã€Œæœ€çµ‚è»¸ã€é–‹å§‹é€£çºŒæ’åˆ—ï¼Œ<br>å°æ–¼éœ€è¦å¤§é‡è¿´åœˆè¨ˆç®—çš„è³‡æ–™ï¼Œè«‹æ”¾å…¥é€™ä¸€è»¸ã€‚ |

### NDA
+ ä¸€ç¶­ NDA (è½‰ç½®ç„¡æ•ˆã€ç›¸ä¹˜æ™‚è‡ªå‹•èª¿æ­£è¡Œåˆ—ã€ç›¸ä¹˜çµæœå¿…ç„¶æ˜¯ä¸€ç¶­ NDA)
  ```py
  np.array([2.0, 4.0]) # shape: (2,)
  ```
+ äºŒç¶­ NDA (è½‰ç½®æœ‰æ•ˆ)
  ```py
  np.array([2.0, 4.0]) # shape: (1, 2)
  ```
+ ä¸€ç¶­ NDA <-> äºŒç¶­ NDA
  ```py
    a = np.array([2.0, 4.0])
    print(a)
    # [2. 4.]
    
    b = a[:, None]
    print(b)
    # [[2.]
    #  [4.]]
    
    c = a[None, :]
    print(c)
    # [[2. 4.]]
    
    d = b[:, 0]
    print(d)
    # [2. 4.]
  ```
+ [<mark>broadcasting</mark>](https://steam.oxxostudio.tw/category/python/numpy/numpy-broadcast.html)ï¼šå°‡å° NDA æ“´å±•æˆå¤§ NDAï¼Œä»¥ä¾¿å…¼å®¹ NDA çš„å››å‰‡é‹ç®— (`+`ã€`-`ã€`*`ã€`/`)

## Class

### é™£åˆ— [`ndarray`](https://www.delftstack.com/zh-tw/tutorial/python-numpy/numpy-ndarray/)

+ ç´¢å¼•æ–¹å¼
  ```py
  array_3D[å±¤, åˆ—, è¡Œ]
  array_3D[å±¤][åˆ—][è¡Œ]
  array_3D[1, 2, 3]         # ã€ç¬¬ 1 å±¤ã€‘-ã€ç¬¬ 2 åˆ—ã€‘-ã€ç¬¬ 3 è¡Œã€‘çš„é‚£å€‹å…ƒç´ 
  array_3D[1][2][3]
  array_3D[1:3, 2:4, 3:5]   # ã€ç¬¬ 1~2 å±¤ã€‘-ã€ç¬¬ 2~3 åˆ—ã€‘-ã€ç¬¬ 3~4 è¡Œã€‘çš„é‚£äº›å…ƒç´ 
  array_3D[1:3][2:4][3:5]
  array_3D[:, :, 1]         # ã€ç¬¬ 1 è¡Œã€‘çš„é‚£äº›å…ƒç´ 
  array_3D[:][:][1]
  ```

+ å±¬æ€§
  | å±¬æ€§ | èªªæ˜ |
  |------|------|
  | `ndim` | å¹¾éšå¼µé‡ |
  | `size` | å…ƒç´ æ•¸é‡ |
  | `shape` | å½¢ç‹€ (å±¤, åˆ—, è¡Œ) |
  | `dtype` | è³‡æ–™å‹æ…‹ |
  | `real` | å¯¦éƒ¨ |
  | `imag` | è™›éƒ¨ |
  | `T` | è½‰ç½® |

+ æ–¹æ³•
  | æ–¹æ³• | èªªæ˜ |
  |------|------|
  | `transpose()` | è½‰ç½® |
  | `sum(axis=)` | ç¸½å’Œ |
  | `cumsum(axis=)` | ç´¯ç©ç¸½å’Œ |
  | `min(axis=)` | æœ€å°å€¼ |
  | `max(axis=)` | æœ€å¤§å€¼ |
  | `mean(axis=)` | å¹³å‡æ•¸ |
  | `var(axis=)` | è®Šç•°æ•¸ |
  | `std(axis=)` | æ¨™æº–å·® |
  | `item(2,3,1)` | ç­‰åŒ `arr[2][3][1]` |
  | `itemset((2,3,1), 10)` | ç­‰åŒ `arr[2][3][1] = 10` |
  | `all(axis=)` | æ˜¯å¦å…¨ç‚º True |
  | `any(axis=)` | æ˜¯å¦æœ‰ä»»ä¸€ True |
  | `flatten()` | å£“å¹³ï¼ˆæ·±æ‹·è²ï¼‰ |
  | `ravel()` | å£“å¹³ï¼ˆæ·ºæ‹·è²ï¼‰ |
  | `reshape(shape)` | é‡å¡‘ |
  | `unique(axis=)` | æŒ‘å‡ºç¨ç‰¹å…ƒç´ ä¸¦æ’åº |
  | `clip(a_min=,a_max=)` | å…ƒç´ è¶…é a_max å‰‡ç‚º a_maxï¼Œå°‘æ–¼ a_min å‰‡ç‚º a_min |

+ åƒæ•¸
  + `unique()`
    | åƒæ•¸ | èªªæ˜ |
    |------|------|
    | `return_index=True` | å›å‚³ç¨ç‰¹é™£åˆ—åœ¨åŸé™£åˆ—ç¬¬ä¸€æ¬¡å‡ºç¾çš„ç´¢å¼• |
    | `return_inverse=True` | å›å‚³é‡å»ºåŸé™£åˆ—æ‰€éœ€çš„ç¨ç‰¹é™£åˆ—ç´¢å¼• |

### è³‡æ–™å‹åˆ¥ `dtype`

+ å…§å»ºå‹åˆ¥
  | å‹åˆ¥ | èªªæ˜ |
  |------|------|
  | `np.bool_` | å¸ƒæ— |
  | `np.string_` | ASCII å­—ä¸² |
  | `np.unicode_` | Unicode å­—ä¸² |
  | `np.int_` | æœ‰è™Ÿæ•´æ•¸ (é è¨­ int32) |
  | `np.int8/16/32/64/128/256` | æŒ‡å®šä½æ•¸æœ‰è™Ÿæ•´æ•¸ |
  | `np.uint8/16/32/64/128/256` | æŒ‡å®šä½æ•¸ç„¡è™Ÿæ•´æ•¸ |
  | `np.float_` | æµ®é»æ•¸ (é è¨­ float64) |
  | `np.float16/32/64/80/96/128/256` | æŒ‡å®šä½æ•¸æµ®é»æ•¸ |
  | `np.complex_` | è¤‡æ•¸ (é è¨­ complex128) |
  | `np.complex64/128` | æŒ‡å®šä½æ•¸è¤‡æ•¸ |

+ è‡ªè¨‚å‹åˆ¥
  ```py
  Student = np.dtype([
      ('name', np.str_, 16),
      ('grades', np.float64, (2,))
  ])

  # struct Student
  # {
  #     string name[16];
  #     float64 grades[2];
  # };

  arr = np.array([
      ('Sarah', (8.0, 7.0)), 
      ('John', (6.0, 7.0))
  ], dtype=Student)

  print(arr[1]["name"])      # John
  print(arr[1]["grades"])    # [6. 7.]
  print(arr[:]["grades"])    # [[8. 7.] [6. 7.]]
  ```
### æ—¥æœŸ `datetime64`
+ ä½¿ç”¨
  ```py
  # æ•´æ•¸ï¼šè‡ª UNIX ç´€å…ƒæ™‚é–“é–‹å§‹åç§»å¤šä¹…
  np.datetime64(1699518619, 's') # 2023-11-09T08:30:19
  # å­—ä¸²ï¼šè½‰æˆæ—¥æœŸï¼Œå¯æŒ‡å®šç²¾åº¦
  np.datetime64('2023-11-09T08:30:19', 'D') # 2023-11-09
  ```

### æ™‚é–“å·® `timedelta64`
+ ä½¿ç”¨
  ```py
  # æ•´æ•¸ï¼šåç§»é‡
  np.datetime64('2009') + np.timedelta64(20, 'D') == np.datetime64('2009-01-21')
  ```

## Constant

### Math
+ è®Šæ•¸
  | å¸¸æ•¸ | èªªæ˜ |
  |------|------|
  | `np.pi` | åœ“å‘¨ç‡ |
  | `np.e` | è‡ªç„¶å¸¸æ•¸ |

## Function

### Factory
+ å‡½æ•¸
  | å‡½æ•¸ | èªªæ˜ |
  |------|------|
  | `array(array_like)` | å¾é™£åˆ—é¡å‹ç‰©ä»¶å»ºç«‹ |
  | `asarray(array_like)` | è½‰æ›ç‚ºé™£åˆ— |
  | `arange(start, stop, step)` | ç­‰å·®æ•¸åˆ— |
  | `linspace(èµ·é», çµ‚é», æ•¸é‡)` | å‡å‹»åˆ†å‰²å€é–“ |
  | `zeros(shape)` | å…¨é›¶é™£åˆ— |
  | `zeros_like(NDA)` | èˆ‡æŒ‡å®šé™£åˆ—åŒå½¢ç‹€çš„å…¨é›¶é™£åˆ— |
  | `ones(shape)` | å…¨ä¸€é™£åˆ— |
  | `ones_like(NDA)` | èˆ‡æŒ‡å®šé™£åˆ—åŒå½¢ç‹€çš„å…¨ä¸€é™£åˆ— |
  | `empty(shape)` | æœªåˆå§‹åŒ–é™£åˆ— |
  | `empty_like(NDA)` | èˆ‡æŒ‡å®šé™£åˆ—åŒå½¢ç‹€çš„æœªåˆå§‹åŒ–é™£åˆ— |
  | `full(shape, å€¼)` | æŒ‡å®šå€¼å¡«å……é™£åˆ— |
  | `full_like(NDA, å€¼)` | èˆ‡æŒ‡å®šé™£åˆ—åŒå½¢ç‹€çš„æŒ‡å®šå€¼é™£åˆ— |
  | `eye(åˆ—, è¡Œ, k=å‘å³ä½ç§»)` | å°è§’çŸ©é™£ |
  | `identity(n)` | n éšå–®ä½çŸ©é™£ |
  | `tri(n)` | n éšå–®ä½ä¸‹ä¸‰è§’çŸ©é™£ |
  | `tril(åˆ—, è¡Œ, k=èƒŒå°0çš„ä½ç§»)` | ä¸‹ä¸‰è§’çŸ©é™£ |
  | `triu(åˆ—, è¡Œ, k=èƒŒå°0çš„ä½ç§»)` | ä¸Šä¸‰è§’çŸ©é™£ |
  | `meshgrid(xåº§æ¨™é», yåº§æ¨™é»)` | ç¶²æ ¼åŒ–ï¼šè¿”å› x çŸ©é™£ã€y çŸ©é™£ |
  | `mgrid[xåº§æ¨™é»slice, yåº§æ¨™é»slice]` | ç¶²æ ¼åŒ–ï¼šè¿”å› x çŸ©é™£ã€y çŸ©é™£ (ä¸€èˆ¬)|
  | `ogrid[xåº§æ¨™é»slice, yåº§æ¨™é»slice]` | ç¶²æ ¼åŒ–ï¼šè¿”å› x çŸ©é™£ã€y çŸ©é™£ (ç¨€ç–)|
  | `argmax(NDA, axis=)` | æœ€å¤§å€¼çš„ç´¢å¼• |
  | `argmin(NDA, axis=)` | æœ€å°å€¼çš„ç´¢å¼• |

+ åƒæ•¸
  + `linspace()`
    | åƒæ•¸ | èªªæ˜ |
    |------|------|
    | `endpoint=True/False` | æ˜¯å¦åŒ…å«çµ‚é» |
    | `retstep=True/False` | æ˜¯å¦å›å‚³æ­¥é€²å€¼ |
  + `array()` / `asarray()`
    | åƒæ•¸ | èªªæ˜ |
    |------|------|
    | `object` | é™£åˆ—ç‰©ä»¶ |
    | `dtype=None` | å…ƒç´ è³‡æ–™å‹åˆ¥ |
    | `copy=True` | æ˜¯å¦æ·±æ‹·è² |
    | `order='K'` | è¨˜æ†¶é«”å„²å­˜æ–¹å¼ |
    | `subok=False` | æ˜¯å¦å…è¨±å­é¡åˆ¥ç¹¼æ‰¿ |
    | `ndmin=0` | æœ€å°ç¶­åº¦ |
  + `sum()`
    | åƒæ•¸ | èªªæ˜ |
    |------|------|
    | `object` | é™£åˆ—ç‰©ä»¶ |
    | `axis=1` | å°ç¬¬å¹¾è»¸é€²è¡Œæ“ä½œ |
    | `keepdims=True/False` | ä¿ç•™åŸæœ‰ç¶­åº¦ |
    > + åŸ NDA
    > 	```
    > 	[[1, 2, 3],
    > 	[4, 5, 6]]
    > 	```
    > + æœ‰ keepdims
    > 	```
    > 	[[6],
    > 	[15]]
    > 	```
    > + æœª keepdims
    > 	```
    > 	[6, 15]
    > 	```

### Math
+ å‡½æ•¸
  | å‡½æ•¸ | èªªæ˜ |
  |------|------|
  | `abs(NDA)` | çµ•å°å€¼ |
  | `floor(NDA)` | å‘ä¸‹å–æ•´ |
  | `ceil(NDA)` | å‘ä¸Šå–æ•´ |
  | `power(åº•æ•¸NDA, æŒ‡æ•¸NDA)` | å†ªé‹ç®— |
  | `exp(NDA)` | e çš„æŒ‡æ•¸æ¬¡æ–¹ |
  | `sqrt(åº•æ•¸NDA)` | å¹³æ–¹æ ¹ |
  | `log(çœŸæ•¸NDA)` | è‡ªç„¶å°æ•¸ |
  | `log10(çœŸæ•¸NDA)` | å¸¸ç”¨å°æ•¸ |
  | `radians(è§’åº¦)` | è§’åº¦è½‰å¼§åº¦ |
  | `degrees(å¼§åº¦)` | å¼§åº¦è½‰è§’åº¦ |
  | `sin()` | æ­£å¼¦ |
  | `cos()` | é¤˜å¼¦ |
  | `tan()` | æ­£åˆ‡ |
  | `asin()` | åæ­£å¼¦ |
  | `acos()` | åé¤˜å¼¦ |
  | `atan()` | åæ­£åˆ‡ |
  | `arcsinh()` | åé›™æ›²æ­£å¼¦ |
  | `arccosh()` | åé›™æ›²é¤˜å¼¦ |
  | `arctanh()` | åé›™æ›²æ­£åˆ‡ |

### Calculate
+ å‡½æ•¸
  | å‡½æ•¸ | èªªæ˜ |
  |------|------|
  | `dot(NDA, NDA)` | å…§ç©ï¼ˆç­‰åŒ `NDA @ NDA`ï¼‰ |
  | `cross(NDA, NDA)` | å¤–ç© |
  | `allclose(NDA, NDA, ç›¸å°èª¤å·®, çµ•å°èª¤å·®)` | åˆ¤æ–·æ˜¯å¦å¤§è‡´ç›¸ç­‰ |
  | `average(NDA, axis=, weights=)` | ç®—è¡“å¹³å‡æˆ–åŠ æ¬Šå¹³å‡ |

### Condition
+ å‡½æ•¸
  | å‡½æ•¸ | èªªæ˜ |
  |------|------|
  | `count_nonzero(æ¢ä»¶)` | è¨ˆç®—ç¬¦åˆæ¢ä»¶çš„å…ƒç´ æ•¸é‡ |
  | `where(æ¢ä»¶, xæ“ä½œ, yæ“ä½œ)` | ç„¡ xã€y æ“ä½œæ™‚å›å‚³æ»¿è¶³æ¢ä»¶çš„ tuple[å±¤ç´¢å¼•, åˆ—ç´¢å¼•, è¡Œç´¢å¼•]ï¼›æœ‰æ™‚åŸ·è¡Œå°æ‡‰æ“ä½œä¸¦å›å‚³ NDA |
  | `clip(NDA, min, max)` | é™åˆ¶æ•¸å€¼ç¯„åœ |

### Operation
+ å‡½æ•¸
  | å‡½æ•¸ | èªªæ˜ |
  |------|------|
  | `transpose(NDA, axes)` | è½‰ç½® |
  | `vstack(NDA, NDA)` | å‚ç›´å †ç–Š |
  | `hstack(NDA, NDA)` | æ°´å¹³å †ç–Š |
  | `vsplit(NDA, å¡Šæ•¸)` | å‚ç›´åˆ†å‰² |
  | `hsplit(NDA, å¡Šæ•¸)` | æ°´å¹³åˆ†å‰² |
  | `append(NDA, NDA, axis=)` | é™„åŠ å…ƒç´ ï¼ˆå‰µå»ºæ–°é™£åˆ—ï¼‰ |
  | `repeat(NDA, é‡è¤‡æ¬¡æ•¸, axis=)` | é‡è¤‡å…ƒç´  |

### Setting
+ å‡½æ•¸
  | å‡½æ•¸ | èªªæ˜ |
  |------|------|
  | `set_printoptions(åƒæ•¸)` | æ›´æ”¹åˆ—å°åƒæ•¸ |

+ åƒæ•¸
  + `set_printoptions()`
    | åƒæ•¸ | èªªæ˜ |
    |------|------|
    | `precision=None` | å°æ•¸ç²¾ç¢ºåº¦ |
    | `threshold=None` | å…ƒç´ é–€æª»å€¼ï¼ˆè¶…éå‰‡çœç•¥ä¸­é–“éƒ¨åˆ†ï¼‰ |
    | `edgeitems=None` | çœç•¥æ™‚å‰å¾Œé¡¯ç¤ºçš„å…ƒç´ æ•¸é‡ |
    | `linewidth=None` | è¡Œå¯¬åº¦ |
    | `suppress=None` | æŠ‘åˆ¶é¡¯ç¤ºå°æ•¸ä½ |
    | `nanstr=None` | NaN å€¼é¡¯ç¤ºå­—ä¸² |
    | `infstr=None` | ç„¡é™å€¼é¡¯ç¤ºå­—ä¸² |
    | `formatter=None` | è‡ªè¨‚æ ¼å¼åŒ–å‡½æ•¸ |
    | `sign=None` | æ­£è² è™Ÿæ§åˆ¶ |
    | `floatmode=None` | æµ®é»æ•¸é¡¯ç¤ºæ¨¡å¼ |

## Tips

### Vectorization

+ å–®è®Šæ•¸
  ```py
  a = np.arange(10)
  print(a)          # [0 1 2 3 4 5 6 7 8 9]
  print(a + 1)      # [1  2  3  4  5  6  7  8  9  10]
  print(a < 5)      # [True True True True True False False False False False]
  ```

+ å¤šè®Šæ•¸
  ```py
  x = np.linspace(-1, 1, 3)
  y = np.linspace(-1, 1, 3)
  z = x**2 + y**2

  print(x) # [-1. 0. 1.]
  print(y) # [-1. 0. 1.]
           #   |  |  |
           #   v  v  v
  print(z) # [ 2. 0. 2.]
  ```

### Random
```py
# èˆŠ API (np.random)
np.random.seed(42)
np.random.randn(3, 2)   # æ­£æ…‹åˆ†ä½ˆ
np.random.rand(3, 2)    # å‡å‹»åˆ†ä½ˆ

# æ–° API (Generator)
rng = np.random.default_rng(42)

rng.standard_normal((3, 2))  # å–ä»£ randn()
rng.random((3, 2))           # å–ä»£ rand()
rng.integers(0, 10, (3, 2))  # å–ä»£ randint()
```
